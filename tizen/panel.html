<!DOCTYPE html>
<html>
<head><title>Panel Zarządzania URL</title></head>
<body>
    <h2>Ustaw URL dla TV</h2>
    <input type="text" id="urlInput" size="60" />
    <button onclick="setUrl()">Ustaw</button>
    <p id="status"></p>

    <script>
        const apiBase = 'http://' + window.location.hostname + ':5000';

        async function loadUrl() {
            try {
                const res = await fetch(apiBase + '/get_url');
                const data = await res.json();
                document.getElementById('urlInput').value = data.url;
            } catch(e) {
                document.getElementById('status').textContent = "Błąd ładowania URL: " + e.message;
            }
        }

        async function setUrl() {
            const url = document.getElementById('urlInput').value;
            try {
                const res = await fetch(apiBase + '/set_url', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({url})
                });
                const data = await res.json();
                if (data.status === "ok") {
                    document.getElementById('status').textContent = "URL ustawiony!";
                } else {
                    document.getElementById('status').textContent = "Błąd: " + (data.message || "nieznany");
                }
            } catch(e) {
                document.getElementById('status').textContent = "Błąd wysyłania: " + e.message;
            }
        }

        loadUrl();
    </script>
</body>
</html>
